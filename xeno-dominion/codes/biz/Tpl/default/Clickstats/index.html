<include file="Public:header" />

<include file="Public:left_menu" />  
 
<div id="content" style="height:auto;">

<script>
	$(function() {
		var dates = $( "#from, #to" ).datepicker({
			dateFormat: "yy-mm-dd",
			defaultDate: "-1m",
			changeMonth: true,
			changeYear: true,
			numberOfMonths: 2,
			maxDate: 'today',
			onSelect: function( selectedDate ) {
				var option = this.id == "from" ? "minDate" : "maxDate",
					instance = $( this ).data( "datepicker" ),
					date = $.datepicker.parseDate(
						instance.settings.dateFormat ||
						$.datepicker._defaults.dateFormat,
						selectedDate, instance.settings );
				dates.not( this ).datepicker( "option", option, date );
			}
		});
	});
</script>

<div class="demo">
<label for="from">From</label>
<input type="text" id="from" name="from" />
<label for="to">to</label>
<input type="text" id="to" name="to" />
&nbsp; <input type="button" id="submitdate" name="submitdate" value="Submit" />
</div>

<h3>Company Click Statistics</h3>
Selected Date: <span style="color:#069"><?php
if($d1 == $d2){
    	echo $d1;
    }else{
    	echo $d1." - ".$d2;
    }
?></span>
<table class="statstable" cellspacing="1">
<?php
if($count_year_company_click_select == 0){
	echo "<tr><td>There is no data fetched from specified date</td></tr>";
}else{
	?>
    <tr><th width="150px">Unique Anonymous Click</th><th width="110px">Unique User Click</th><th width="110px">Unique Total Click</th><th width="130px">Anonymous Click</th><th width="90px">User Click</th><th width="90px">Total Click</th><th width="130px"></th></tr>
    <tr><td>{$year_company_click_sum[0]['a_unik_click_sum']}</td><td>{$year_company_click_sum[0]['u_unik_click_sum']}</td><td>{$year_company_click_sum[0]['click_unik_counter_sum']}</td><td>{$year_company_click_sum[0]['a_click_sum']}</td><td>{$year_company_click_sum[0]['u_click_sum']}</td><td>{$year_company_click_sum[0]['click_counter_sum']}</td><td><input type="button" name="year_company_click_detail" id="year_company_click_detail" value="View Detail" /></td></tr>
    <?php
}
?>
</table>
<div id="year_company_click_detail_div"></div>

<script type="text/javascript">
$(document).ready(function(){
	$("#year_company_click_detail_div").hide();		   
});

var d1 = "<?php echo $d1; ?>";
var d2 = "<?php echo $d2; ?>";
var cid = "<?php echo $cid; ?>";
var year_company_click_check = 0;

$("#submitdate").click(function(){
	var d1 = $("#from").val();
	var d2 = $("#to").val();
	var url = "{$SITE_URL}/biz.php/Clickstats/index/d1/"+d1+"/d2/"+d2;
	var cid = "<?php echo $cid; ?>";
	
	location.href = url;
});

$("#year_company_click_detail").click(function(){
	if(year_company_click_check == 0){
		$("#year_company_click_detail_div").show();
		var dataString = "d1="+d1+"&d2="+d2+"&cid="+cid;
		//alert(dataString);
		$.ajax({
			type: "POST",
			url: "{$SITE_URL}/biz.php/Clickstats/loadYearCompanyClick",
			data: dataString,
			success: function(returndata){
				$("#year_company_click_detail_div").html(returndata);;
			}
		});
		$("#year_company_click_detail").val("Hide Detail");
		year_company_click_check = 1;
	}else if(year_company_click_check == 1){
		$("#year_company_click_detail_div").hide();
		$("#year_company_click_detail").val("View Detail");
		year_company_click_check = 0;
	}
});
</script>


<h3>Product Click Statistics</h3>
Selected Date: <span style="color:#069"><?php
if($d1 == $d2){
    	echo $d1;
    }else{
    	echo $d1." - ".$d2;
    }
?></span>
<table class="statstable" cellspacing="1">
<?php
if($count_year_product_click_select == 0){
	echo "<tr><td>There is no data fetched from specified date</td></tr>";
}else{
	?>
    <tr><th width="60px">Product ID</th><th width="150px">Unique Anonymous Click</th><th width="110px">Unique User Click</th><th width="110px">Unique Total Click</th><th width="130px">Anonymous Click</th><th width="90px">User Click</th><th width="90px">Total Click</th><th width="130px"></th></tr>
    <foreach name="year_product_click_sum" item="vo">
    <tr><td>{$vo.pid}</td><td>{$vo.a_unik_click_sum}</td><td>{$vo.u_unik_click_sum}</td><td>{$vo.click_unik_counter_sum}</td><td>{$vo.a_click_sum}</td><td>{$vo.u_click_sum}</td><td>{$vo.click_counter_sum}</td><td><input type="button" class="year_product_click_detail" name="year_product_click_detail" id="year_product_click_detail" title="{$vo.pid}" value="View Detail" /></td></tr>
    <tr class="year_product_click_detail_tr" id="tr{$vo.pid}"></tr>
    </foreach>
    <?php
}
?>
</table>

<script type="text/javascript">
$(document).ready(function(){
	$(".year_product_click_detail_tr").hide();	   
});
$(".year_product_click_detail").click(function(){
	var button_value = $(this).val();
	var pid = $(this).attr('title');
	var tr_id = "tr"+pid;
	if(button_value == "View Detail"){
		
		$("#"+tr_id).show();
		var dataString = "d1="+d1+"&d2="+d2+"&cid="+cid+"&pid="+pid;
		$.ajax({
			type: "POST",
			url: "{$SITE_URL}/biz.php/Clickstats/loadYearProductClick",
			data: dataString,
			success: function(returndata){
				//alert(returndata);
				$("#"+tr_id).html(returndata);;
			}
		});
		$(this).val("Hide Detail");
	}else if(button_value == "Hide Detail"){
		$("#"+tr_id).hide();
		$(this).val("View Detail");
	}
	
});

</script>
</div>
<include file="Public:footer" />